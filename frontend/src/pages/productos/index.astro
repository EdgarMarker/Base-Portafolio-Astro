---
import "../../styles/products.css";

import { Picture } from "astro:assets";
import { getDataProducts } from "../../_data/products";
import type { Products } from "../../_types/products";
import PortableTextCustom from "../../components/ui/PortableTextCustom";
import Layout from "../../layouts/Layout.astro";
import CardProduct from "../../components/ui/CardProduct";
import type { Product } from "../../_types/products-product";
import { getDataProduct } from "../../_data/products-product";

const dataProducts: Products = await getDataProducts();
const dataProduct: Product[] = await getDataProduct();
---

<Layout
  title={dataProducts.titleseo}
  desc={dataProducts.descseo}
  keywords={dataProducts.keyseo}
>
  <section id="hero">
    <div class="column__2">
      <div class="col__left">
        <h1>{dataProducts.heroH1}</h1>
        <PortableTextCustom data={dataProducts.heroH2} client:only="react" />
        <p>{dataProducts.heroP}</p>
        <div class="btn">{dataProducts.heroBtn}</div>
      </div>
      <div class="col__right">
        <Picture
          src={dataProducts.heroImg.media.url}
          alt={dataProducts.heroImg.alt.altText}
          formats={["webp", "avif"]}
          fallbackFormat="jpeg"
          inferSize={true}
          quality={"high"}
          densities={[1.5, 2]}
        />
      </div>
    </div>
  </section>
  <section id="products__product">
    <ul role="list" class="listado__x3">
      {
        dataProduct
          .sort(
            (a, b) =>
              new Date(a.publishedAt).getTime() -
              new Date(b.publishedAt).getTime()
          )
          .map((data) => (
            <CardProduct
              className="card__recentProduct"
              data={data}
              from="productos"
            >
              <Picture
                src={data.mainImage.media.url}
                alt={data.mainImage.alt.altText}
                formats={["webp", "avif"]}
                fallbackFormat="jpeg"
                inferSize={true}
                quality={"high"}
                densities={[1.5, 2]}
              />
            </CardProduct>
          ))
      }
    </ul>
  </section>
</Layout>
